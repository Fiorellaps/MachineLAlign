-------- 0.01% de los datos; 9000 ----------
1) Decision Tree Classifier
[[0.51828299 0.09220986 0.10015898 0.28934817]
 [0.1416309  0.50858369 0.19098712 0.15879828]
 [0.09344262 0.10983607 0.58688525 0.20983607]
 [0.07672414 0.05431034 0.09310345 0.77586207]]
DecisionTreeClassifier(criterion='entropy', max_depth=9, min_samples_leaf=3,
                       min_samples_split=4): Accuracy = 0.6356020942408377

2) Random Forest 
[[0.55007949 0.11128776 0.07949126 0.25914149]
 [0.01716738 0.74463519 0.15236052 0.08583691]
 [0.00655738 0.1852459  0.62295082 0.1852459 ]
 [0.02241379 0.06551724 0.05       0.86206897]]
RandomForestClassifier(max_depth=20, min_samples_leaf=5, min_samples_split=12,
                       n_estimators=300, random_state=0): Accuracy = 0.7235602094240837

3) Gradient Boosting
[[0.6836248  0.05564388 0.05882353 0.20190779]
 [0.04077253 0.69957082 0.15665236 0.10300429]
 [0.01803279 0.1442623  0.68852459 0.14918033]
 [0.04655172 0.05258621 0.0612069  0.83965517]]
GradientBoostingClassifier(learning_rate=0.2, max_depth=8, max_features=7,
                           min_samples_leaf=60, min_samples_split=400,
                           n_estimators=300, random_state=10, subsample=0.85): Accuracy = 0.7504363001745201

4) AdaBoost
 0.63

5) KNeighbors
 [0.07586207 0.08534483 0.06810345 0.77068966]]
KNeighborsClassifier(leaf_size=1, p=1): Accuracy = 0.7301919720767889


6) CNN BiLSTM
[[0.         0.26391097 0.73608903 0.        ]
 [0.         0.46566524 0.53433476 0.        ]
 [0.         0.26721311 0.73278689 0.        ]
 [0.         0.15086207 0.84913793 0.        ]]
<tensorflow.python.keras.wrappers.scikit_learn.KerasClassifier object at 0x000001AF039E88E0>: Accuracy = 0.23176265270506108
0.01{'batch_size': 512, 'epochs': 5, 'optimizer': 'rmsprop'}


-------- 0.05% de los datos; 45000 ----------

1) Decision Tree Classifier
[[0.57224698 0.12380649 0.05697008 0.24697645]
 [0.06818182 0.70711835 0.10634648 0.11835334]
 [0.04292267 0.20216252 0.56225426 0.19266055]
 [0.03294808 0.08797654 0.04122822 0.83784716]]
DecisionTreeClassifier(criterion='entropy', max_depth=9, min_samples_leaf=3,
                       min_samples_split=4): Accuracy = 0.6995741115688054

2) Random Forest Classifier
[[0.66868237 0.05506047 0.0334182  0.24283896]
 [0.02058319 0.78559177 0.10977702 0.08404803]
 [0.01245085 0.13794233 0.69364351 0.1559633 ]
 [0.01086769 0.04347076 0.02742798 0.91823357]]
RandomForestClassifier(criterion='entropy', max_depth=30, min_samples_leaf=5,
                       min_samples_split=12, n_estimators=200, random_state=0): Accuracy = 0.7940375619632758

3) Gradient Boosting
[[0.76511776 0.04614895 0.02291534 0.16581795]
 [0.03173242 0.75343053 0.12564322 0.08919383]
 [0.01408912 0.10878113 0.75360419 0.12352556]
 [0.03829567 0.03070554 0.03864068 0.89235812]]
GradientBoostingClassifier(learning_rate=0.2, max_depth=8, max_features=7,
                           min_samples_leaf=60, min_samples_split=400,
                           n_estimators=300, random_state=10, subsample=0.85): Accuracy = 0.8122600013963555

4) AdaBoost
[[0.47899427 0.11489497 0.06715468 0.33895608]
 [0.05360206 0.68096055 0.13250429 0.1329331 ]
 [0.05275229 0.18152031 0.53047182 0.23525557]
 [0.04881835 0.07158875 0.05261342 0.82697947]]
AdaBoostClassifier(learning_rate=0.4, n_estimators=300): Accuracy = 0.6636877749074914

5) KNeighbors
[[0.79598982 0.04583068 0.0264163  0.13176321]
 [0.04674099 0.75343053 0.1170669  0.08276158]
 [0.01867628 0.12155963 0.74705111 0.11271298]
 [0.05865103 0.04053821 0.04657582 0.85423495]]
KNeighborsClassifier(leaf_size=1, p=1): Accuracy = 0.802206241709139

6) CNN BiLSTM
[[0.67695735 0.02164227 0.06683641 0.23456397]
 [0.12950257 0.55960549 0.22341338 0.08747856]
 [0.07470511 0.06651376 0.77981651 0.07896461]
 [0.07124375 0.02673797 0.13403485 0.76798344]]
<tensorflow.python.keras.wrappers.scikit_learn.KerasClassifier object at 0x000001D01A159E80>: Accuracy = 0.7166096488165887
{'batch_size': 512, 'epochs': 5, 'optimizer': 'rmsprop'}

-------- 0.1% de los datos; 95486 ----------

1) Decision Tree
[[0.57208784 0.08895608 0.0700191  0.26893698]
 [0.06219172 0.60733433 0.14861677 0.18185717]
 [0.03144963 0.13546274 0.6003276  0.23276003]
 [0.03708815 0.06063481 0.04183198 0.86044506]]
DecisionTreeClassifier(criterion='entropy', max_depth=9, min_samples_leaf=3,
                       min_samples_split=8): Accuracy = 0.7005515604272848

2) Random Forest
[[0.72803947 0.03389561 0.01893698 0.21912794]
 [0.01565516 0.8065623  0.09607549 0.08170706]
 [0.004914   0.11367731 0.74561835 0.13579034]
 [0.01069519 0.03769191 0.0225979  0.92901501]]
RandomForestClassifier(criterion='entropy', max_depth=20, min_samples_leaf=5,
                       min_samples_split=12, n_estimators=400, random_state=0): Accuracy = 0.8259093765272638

3)Gradient Boosting
[[0.79535328 0.02721197 0.02036919 0.15706556]
 [0.02659232 0.80162985 0.09500322 0.07677461]
 [0.00966421 0.1049959  0.77231777 0.11302211]
 [0.03674314 0.03199931 0.0370019  0.89425565]]
GradientBoostingClassifier(learning_rate=0.2, max_depth=8, max_features=7,
                           min_samples_leaf=60, min_samples_split=400,
                           n_estimators=300, random_state=10, subsample=0.85): Accuracy = 0.8314947985757174

4)AdaBoost
[[0.49633991 0.10582432 0.07320178 0.32463399]
 [0.06304954 0.66545143 0.13617843 0.13532061]
 [0.04897625 0.17608518 0.55413595 0.22080262]
 [0.03087804 0.08081766 0.05252717 0.83577713]]
AdaBoostClassifier(learning_rate=0.4, n_estimators=300): Accuracy = 0.673566990155

5) KNeighbors
[[0.82765754 0.02577976 0.01400382 0.13255888] 
 [0.04331975 0.7911216  0.09822003 0.06733862] 
 [0.01343161 0.0964783  0.78771499 0.1023751 ] 
 [0.05916854 0.03139555 0.04467828 0.86475763]]
KNeighborsClassifier(leaf_size=1, p=1): Accuracy = 0.8282133631222509

6) CNN BiLSTM
[[0.66040738 0.06365372 0.04885423 0.22708466]
 [0.01672743 0.76259919 0.12824362 0.09242977]
 [0.00589681 0.11466011 0.77231777 0.10712531]
 [0.02440918 0.04993962 0.06210109 0.86355011]]
<tensorflow.python.keras.wrappers.scikit_learn.KerasClassifier object at 0x000001CEA46E2B80>: Accuracy = 0.7831110800809886
{'batch_size': 512, 'epochs': 5, 'optimizer': 'rmsprop'}
------------------------------------------------------------------------
-------- 100% de los datos; 900.000 con parametros Ã³ptimos ----------

1) Decision Tree
[[0.5658747  0.08760483 0.0877958  0.25872468]
 [0.0571447  0.65455871 0.15361523 0.13468136]
 [0.02586574 0.16115716 0.6127019  0.2002752 ]
 [0.02841223 0.05641906 0.05145943 0.86370929]]
DecisionTreeClassifier(criterion='entropy', max_depth=9, min_samples_leaf=3,
                       min_samples_split=8): Accuracy = 0.71083269042125

2) Random Forest
[[0.79385414 0.0180302  0.00552205 0.18259361]
 [0.01316579 0.8426323  0.09044515 0.05375675]
 [0.00270288 0.09897454 0.79531828 0.10300429]
 [0.00810792 0.01882073 0.01185999 0.96121136]]
RandomForestClassifier(criterion='entropy', max_depth=20, min_samples_leaf=5,
                       min_samples_split=12, n_estimators=400, random_state=0): Accuracy = 0.8698408487137685


3) Gradient Boosting
[[0.81982527 0.01844396 0.00950047 0.1522303 ]
 [0.01779741 0.84201046 0.08632816 0.05386397]
 [0.00524195 0.09243849 0.80323035 0.09908921]
 [0.02842085 0.0196574  0.02268493 0.92923682]]
GradientBoostingClassifier(learning_rate=0.2, max_depth=8, max_features=7,
                           min_samples_leaf=60, min_samples_split=400,
                           n_estimators=300, random_state=10, subsample=0.85): Accuracy = 0.8641820587383098
 
4) AdaBoost
[[0.48765894 0.11903436 0.07444421 0.31886249]
 [0.0581525  0.67248478 0.14100695 0.12835578]
 [0.04368837 0.17341022 0.55394293 0.22895849]
 [0.02994756 0.07396322 0.05316726 0.84292196]]
AdaBoostClassifier(learning_rate=0.4, n_estimators=300): Accuracy = 0.6756581266996443


6)
1306/1306 [==============================] - 2320s 2s/step - loss: 0.2101 - accuracy: 0.8914
[[0.81293464 0.01775967 0.00539474 0.16391095] 
 [0.02693198 0.84507676 0.08158933 0.04640192] 
 [0.0119582  0.07212594 0.82318252 0.09273335] 
 [0.01720777 0.01850159 0.01430962 0.94998102]]



- CNN_BiGRU

 [[0.00158983 0.03656598 0.0063593  0.9554849 ]
 [0.01716738 0.11802575 0.01716738 0.84763948]
 [0.00327869 0.04590164 0.0147541  0.93606557]
 [0.00431034 0.03534483 0.00862069 0.95172414]]
<tensorflow.python.keras.wrappers.scikit_learn.KerasClassifier object at 0x000001BD96B6D910>: Accuracy = 0.40802792321116926
{'batch_size': 512, 'epochs': 5, 'optimizer': 'adadelta'}

[0.00171527 0.38893654 0.00986278 0.59948542]
 [0.00131062 0.18381389 0.01507208 0.79980341]
 [0.         0.10039676 0.00655511 0.89304813]]
CNN_BiGRU: Accuracy = 0.4282622355651749

[[1.59134309e-04 1.75206875e-01 9.54805856e-04 8.23679185e-01]
 [0.00000000e+00 3.63928801e-01 4.93244692e-03 6.31138752e-01]
 [4.91400491e-04 2.11302211e-01 3.11220311e-03 7.85094185e-01]
 [3.45006038e-04 1.00138002e-01 1.98378472e-03 8.97533207e-01]]
CNN_BiGRU: Accuracy = 0.4232004468337639

[[0.01002546 0.18348186 0.06381286 0.74267982]
 [0.00521764 0.39604031 0.11700379 0.48173826]
 [0.00671617 0.16506498 0.18281096 0.64540788]
 [0.00267387 0.09933584 0.05796268 0.8400276 ]]
CNN_BiGRU: Accuracy = 0.44561195280318366